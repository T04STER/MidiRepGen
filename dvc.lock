schema: '2.0'
stages:
  download_dataset:
    cmd: python scripts/download_dataset.py
    deps:
    - path: scripts/download_dataset.py
      hash: md5
      md5: e718ad323b308084cfb4c7770e3aad98
      size: 597
    params:
      params.yaml:
        dataset:
          gdrive_url: https://drive.google.com/file/d/1BDEPaEWFEB2ADquS1VYp5iLZYVngw799/view
          out_zip: data/midi_dataset.zip
          out_unpacked: data/midi_dataset
    outs:
    - path: data/midi_dataset.zip
      hash: md5
      md5: aaece5750b0cfe30b6a3be5c7bb14f83
      size: 192678627
    - path: data/midi_dataset/
      hash: md5
      md5: 6903c5768276dd84ed86a55c334dde93.dir
      size: 271270589
      nfiles: 10855
  midi_to_dataset:
    cmd: python scripts/midi_to_dataset.py
    deps:
    - path: data/midi_dataset/
      hash: md5
      md5: 6903c5768276dd84ed86a55c334dde93.dir
      size: 271270589
      nfiles: 10855
    - path: scripts/midi_to_dataset.py
      hash: md5
      md5: b609f83e13f444746b3921c5ce9ff670
      size: 3544
    params:
      params.yaml:
        dataset:
          gdrive_url: https://drive.google.com/file/d/1BDEPaEWFEB2ADquS1VYp5iLZYVngw799/view
          out_zip: data/midi_dataset.zip
          out_unpacked: data/midi_dataset
    outs:
    - path: data/preprocessed_piano_roll.pkl
      hash: md5
      md5: d233843db19f912b4224c1889e08053e
      size: 1695025925
  midi_to_dataset@piano_roll:
    cmd: python scripts/midi_to_dataset.py --mode piano_roll
    deps:
    - path: data/midi_dataset/
      hash: md5
      md5: 6903c5768276dd84ed86a55c334dde93.dir
      size: 271270589
      nfiles: 10855
    - path: scripts/midi_to_dataset.py
      hash: md5
      md5: b1e0a9e3c7c3784d79f9a833633d4e4b
      size: 4164
    params:
      params.yaml:
        dataset:
          gdrive_url: https://drive.google.com/file/d/1BDEPaEWFEB2ADquS1VYp5iLZYVngw799/view
          out_zip: data/midi_dataset.zip
          out_unpacked: data/midi_dataset
    outs:
    - path: data/preprocessed_piano_roll.pkl
      hash: md5
      md5: d233843db19f912b4224c1889e08053e
      size: 1695025925
  midi_to_dataset@note_events:
    cmd: python scripts/midi_to_dataset.py --mode note_events
    deps:
    - path: data/midi_dataset/
      hash: md5
      md5: 6903c5768276dd84ed86a55c334dde93.dir
      size: 271270589
      nfiles: 10855
    - path: scripts/midi_to_dataset.py
      hash: md5
      md5: c75975d1f2f2d8d3116304a7528dc3db
      size: 5518
    params:
      params.yaml:
        dataset:
          gdrive_url: https://drive.google.com/file/d/1BDEPaEWFEB2ADquS1VYp5iLZYVngw799/view
          out_zip: data/midi_dataset.zip
          out_unpacked: data/midi_dataset
        preprocess.note_count: 8
        preprocess.sample_rate: 1
    outs:
    - path: data/preprocessed_note_events.pkl
      hash: md5
      md5: dc43c850e25f3f719237e34db051fb27
      size: 696320914
    - path: data/preprocessed_note_events_test.pkl
      hash: md5
      md5: 05b147aecc4db90c637a344c51a79073
      size: 76826105
  train_note_event_vae:
    cmd: python scripts/train_note_event_vae.py
    deps:
    - path: data/preprocessed_note_events.pkl
      hash: md5
      md5: dc43c850e25f3f719237e34db051fb27
      size: 696320914
    - path: scripts/train_note_event_vae.py
      hash: md5
      md5: 8003fd4f2f84eb73f2f9e19860417fe0
      size: 6853
    params:
      params.yaml:
        train_note_event_vae.run_name: default_runner
    outs:
    - path: models/default_runner.pt
      hash: md5
      md5: 8cf94cc314f1650baf5f3304b01ace16
      size: 7365429
